const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

const Malware = {
  create: async (filename, file_hash, file_size, file_type, user_id, status) => {
    try {
      // Opsional: panggil prisma.$connect() jika belum pernah terhubung
      await prisma.$connect();

      // Lakukan insert menggunakan prisma.malwarefile.create
      const newMalware = await prisma.malwareFile.create({
        data: {
          filename: filename,
          file_hash: file_hash,
          file_size: file_size,
          file_type: file_type,
          user_id: user_id,
          status: status,
          // Bisa langsung pakai new Date() atau gunakan default pada schema
          upload_date: new Date(), 
        },
      });

      return newMalware;
    } catch (err) {
      console.error('Prisma create error', err);
      throw err;
    }
  },
};

module.exports = Malware;