const config = require('../config/database');

const Malware = {
  create: async (filename, file_hash, file_size, file_type, user_id, status) => {
    try {
      let pool = await sql.connect(config);
      await pool.request()
        .input('filename', sql.VarChar, filename)
        .input('file_hash', sql.VarChar, file_hash)
        .input('file_size', sql.Int, file_size)
        .input('file_type', sql.VarChar, file_type)
        .input('user_id', sql.Int, user_id)
        .input('status', sql.VarChar, status)
        .query('INSERT INTO malware_files (filename, file_hash, file_size, file_type, upload_date, user_id, status) VALUES (@filename, @file_hash, @file_size, @file_type, GETDATE(), @user_id, @status)');
    } catch (err) {
      console.error('SQL error', err);
      throw err;
    }
  }
};

module.exports = Malware;