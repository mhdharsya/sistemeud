const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

const Malware = {
  create: async (filename, file_hash, file_size, file_type, user_id, status, malware_type, risk_level) => {
    try {
      // Pastikan prisma terhubung
      await prisma.$connect();

      // Simpan data ke dalam database
      const newMalware = await prisma.malwareFile.create({
        data: {
          name: filename,
          fileHash: file_hash,
          fileSize: file_size,
          fileType: file_type,
          uploadedBy: user_id,
          status: status,
          uploadDate: new Date(),
          malwareType: malware_type,
          riskLevel: risk_level,      
        },
      });

      return newMalware;
    } catch (err) {
      console.error('Prisma create error', err);
      throw err;
    }
  },
};

module.exports = Malware;
